---
title: "ESM 244: Advanced Data Analysis HW#1"
author: "Nathaniel Burola"
date: "2/3/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## HW1: Data Wrangling and Visualization with Snowshoe Hares 

Installing all the relevant packages for this assignment 
```{r, echo = FALSE, message = FALSE, warning = FALSE, include = FALSE}
r = getOption("repos")
r["CRAN"] = "http://cran.us.r-project.org"
options(repos = r)
install.packages("here")
install.packages("janitor")
install.packages("kableExtra")
install.packages("naniar")
install.packages("VIM")
install.packages("skimr")
install.packages("ggfortify")
install.packages("sf")
install.packages("tmap")
install.packages("tidyverse") 
install.packages("hrbrthemes")
install.packages("viridis")
```

### Attaching all of the relevant packages for this assignment with the library 
```{r, echo = TRUE, message = FALSE, warning = FALSE}
library(tidyverse)
library(janitor)
library(here)
library(kableExtra)
library(naniar)
library(VIM)
library(skimr)
library(ggfortify)
library(sf)
library(tmap)
library(ggplot2)
library(hrbrthemes)
library(viridis)
```

### Reading in the data to form a new dataframe 
```{r}
snowshoe <- read_csv("showshoe_lter.csv")
```

### Data exploring and wrangling 
```{r}
summary(snowshoe) #Gives a summary of how many different variables there are in the dataframe
View(snowshoe) #Opens a new dataframe with the dataset already in it 
names(snowshoe) #Gives the number of column headers in the data set 
head(snowshoe) #Gives a preview of the data set 
tail(snowshoe) #Gives a preview of the data set 

#Initial reaction: Columns that include NA data are the following: time, right ear, sex, age, hindfoot, and notes. 

#What variables may be related to each other with this data? Could include sex, age, and weight. Maybe grid and date? 

#What do you want to graph with the snowshoe data? 

#Statement: I want to see how the weight of all the snowshoe hares both female and male will vary across the years of the study 
```

#Filtering and constructing a new dataframe with desired variables 
```{r}
snowfiltered = subset(snowshoe, select = -c(time, grid, trap, l_ear, r_ear, hindft, notes, b_key, session_id, study)) #Filtered out all the columns that are not desired in the new dataframe 

#Transforming all of the classes of the variables from character to numeric 
```

### Filtering the Dataset 
```{r}
#Filtering the dataset in order to get lower case letters for male and females and filtering out the rest of the NA values 
snow_tidy <- snowfiltered %>%  
  filter(sex %in% c ("f", "m", "M", "F")) %>%  
  mutate(
    sex = case_when(
      sex == "f" ~ "F", 
      sex == "m" ~ "M")) %>%  
  filter(sex!= "NA")
```

### Descriptive introductory summary of what the project is all about (3-4 sentences)  
```{r}
#Snowshore hares, otherwise known as Lepus americanus, are a keystone prey species that play an ecologically important role in northern boreal forests and experience population fluctuations of 8-11 years. This capture-recapture study of snowshoe hares was conducted at 5 locales in the Tanana valley from study sites Tok in the east to Clear in the west from 1999-2012 with a time duration of 13 years. Snowshoe hare population densities were the highest in 1999 and declined thereafter. This study did not find any declines in apparent survival during declining densities in these study populations. 

!["Snowshoe Hare (Lepus Americanus) Source: Northwest Wildlife Preservation Society . “Snowshoe Hare.” Northwest Wildlife Preservation Society, 2020, www.northwestwildlife.com/learn/species-reports/snowshoe-hare/."](\images\snowshoe.png)
```

```

### Finalized graph about the Bonanza Creek snowshoe hare population  
```{r, message = FALSE, warning = FALSE, fig.align="left"}
#Creating a histogram based on the weight of the snowshore hares with a frequency count of the data split between by sex (male/female)
snow_plot <- ggplot(snow_tidy, aes(x=weight, color=sex, fill=sex)) +
  geom_histogram(position="identity", alpha=0.5, brewerPalette="Paired",alpha=0.5) + 
  labs(title="Weight Distribution of Female and Male Snowshoe Hares from 1999 - 2012",x="Weight (g)", y = "Frequency Count of Snowshoe Hares", caption = "Weight distribution of male and female snowshoe hares (Lepus americanus) \n in Bonanza Creek Experimental Forest (1999-2012) \n (Source: https://portal.lternet.edu/nis/metadataviewer?packageid=knb-lter-bnz.55.22)") + 
  theme_bw()

snow_plot+theme(plot.caption=element_text(hjust=0.5))

```

